#!/usr/bin/bash
echo -e "\e[34m---- Disks ----\e[0m"
disks=($(fdisk -l | grep "Disk /" | awk '{print $2}' | rev | cut -c 2- | rev))
for index in "${!disks[@]}"; do
    echo "$index: ${disks[$index]}"
done
echo -n "Select a disk: "; read index
if [ $index -lt 0 ] || [ $index -gt $(( ${#disks[@]} - 1 )) ]; then
	echo -e "\e[31mInvalid input\e[0m"
	exit
fi
echo -e "\e[32mSelected disk ${disks[index]}\e[0m\n"

echo -e "\e[34m---- Partitions ----\e[0m"
sector=$(fdisk -l /dev/sda | grep optimal | rev | awk '{print $2}' | rev)
boot=$(( (268435456 / $sector) - 1 ))
swap=$(( ($(free -b | grep Mem: | awk '{print $2}') / $sector) - 1 ))
(echo g; echo n; echo 1; echo 2048; echo "+$boot"; echo p; echo q;) | fdisk ${disks[index]}